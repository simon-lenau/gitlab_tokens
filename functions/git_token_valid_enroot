# ======================== > git_token_valid_enroot < ======================== #

function git_token_valid_enroot {
    init_doc
    init_desc \
        "Check validity of gitlab container registry token using \`enroot impor\`"
    init_arg "str" "registry_token" \
        "The token for accessing the registry" \
        "glpat-aG2fJfixfGub6ULt2L5_"

    need_help $@ && return $?

    eval "$(parse_arguments "$@")"

    if [ ! -z ${credential} ]; then
        result="$(
            export CISPA_GITLAB_TOKEN="$registry_token"
            enroot import docker://$(git_repo_info --type "registry") \
                2>&1 >/dev/null
        )"
        if [[ $result =~ "Authentication succeeded" ]]; then
            return 0
        else
            return 1
        fi
    else
        return 1
    fi
}
# ────────────────────────────────── <end> ─────────────────────────────────── #
